{% extends 'base.html' %}
{% load static %}
{% block content %}

<section>
    <form method="get" class="flex mb-4 justify-center">
        <select name="type" onchange="form.submit()" class="border rounded p-2 bg-yellow-400 px-20 font-bold">
            <option value="all" {% if option == "all" %}selected{% endif %}>All</option>
            <option value="food" {% if option == "food" %}selected{% endif %}>Food</option>
            <option value="drink" {% if option == "drink" %}selected{% endif %}>Drinks</option>
        </select>
    </form>

    <form method="post" action="{% url 'add_to_cart_all' %}" data-aos="fade-up">
    {% csrf_token %}
        <div class="flex flex-wrap justify-center px-20 gap-6">
            {% for item in menu_items %}
                <div class="flex flex-col border rounded-lg p-4 text-center w-60 bg-gray-400">
                    <img src="{{ item.image.url }}" class="w-40 h-40 object-cover mx-auto rounded-md mb-2" />
                    <h2 class="font-bold text-lg">{{ item.item_name }} (${{ item.price }})</h2>
                    <p class="mb-10">{{ item.menu_item_description }}</p>

                    <input type="hidden" name="item_ids" value="{{ item.id }}">
                    <div class="flex flex-grow"></div>
                    <div class="flex gap-2 justify-center">
                        <button type="button" class="decrement hover:bg-blue-600 cursor-pointer rounded px-2">-</button>
                        <input type="number" name="q{{ item.id }}" value="0" min="0"class="quantity w-16 text-center border rounded">
                        <button type="button" class="increment hover:bg-red-600 cursor-pointer rounded px-2">+</button>
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="flex justify-center m-5 gap-2">
            <p class="text-lg">Table number:</p>
            <input type="number" name="table" value="1" min="1" max='20' class="quantity w-16 text-center border rounded">
        </div>
        <div class="text-center mt-4">
            <button type="submit" class=" text-lg bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded">
                Add All to Cart
            </button>
        </div>
    </form>
</section>

<script>
    document.querySelectorAll('.increment').forEach(button => {
        button.addEventListener('click', () => {
            let container = button.closest('div');
            let input = container.querySelector('.quantity');
            input.value = parseInt(input.value) + 1;
        });
    });

    document.querySelectorAll('.decrement').forEach(button => {
        button.addEventListener('click', () => {
            let container = button.closest('div');
            let input = container.querySelector('.quantity');
            let newValue = parseInt(input.value) - 1;
            if (newValue >= 0) {
                input.value = newValue;
            }
        });
    });
</script>
{% endblock %}
